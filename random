# Apply the cleaning function to remove rows with fewer than 3 words
min_word_count = 3  # Adjust based on your needs
non_rst_cleaned['cleaned_text'] = non_rst_cleaned['processed_text'].apply(lambda x: clean_insufficient_rows(x, min_word_count))

# Drop rows where the text is None (i.e., rows that had insufficient content)
non_rst_cleaned.dropna(subset=['cleaned_text'], inplace=True)

# Print the number of rows retained after cleaning
num_rows_after_cleaning = len(non_rst_cleaned)
print(f"Number of rows after cleaning: {num_rows_after_cleaning}")
