# Function to truncate text to a maximum of 4096 tokens
def truncate_to_4096_tokens(text):
    if isinstance(text, str):  # Ensure that text is a string
        tokens = text.split()
        if len(tokens) > 4096:
            tokens = tokens[:4096]
        return ' '.join(tokens)
    else:
        return ''  # Return an empty string or handle the NaN case appropriately

# Apply the truncation to the 'combined_text' column
df_sample['combined_text'] = df_sample['combined_text'].apply(truncate_to_4096_tokens)
