import pandas as pd
import spacy
from spacy.lang.en.stop_words import STOP_WORDS
import gensim
import matplotlib.pyplot as plt
import seaborn as sns
import re
from collections import Counter

# --------------- N-gram Frequency Analysis ---------------
# Flatten list of tokens
all_tokens = [token for sublist in processed_texts for token in sublist]

# Get the frequency of n-grams
ngram_freq = Counter(all_tokens)

# Select top 20 most frequent n-grams
top_20_ngrams = ngram_freq.most_common(20)

# Create DataFrame for visualization
ngram_df = pd.DataFrame(top_20_ngrams, columns=['ngram', 'frequency'])

# Plot the top 20 n-grams
plt.figure(figsize=(12, 8))  # Increased figure size
sns.barplot(x='ngram', y='frequency', data=ngram_df, palette='coolwarm')  # Changed color palette
plt.xticks(rotation=45, ha='right', fontsize=12)  # Rotated x-axis labels and adjusted font size
plt.yticks(fontsize=12)
plt.title('Top 20 Most Frequent N-grams (Bigrams and Trigrams)', fontsize=16, weight='bold')  # Improved title
plt.xlabel('N-gram', fontsize=14, weight='bold')  # Bold axis labels
plt.ylabel('Frequency', fontsize=14, weight='bold')

# Add data labels for each bar
for index, value in enumerate(ngram_df['frequency']):
    plt.text(index, value + 500, str(value), ha='center', fontsize=12)  # Added data labels

# Show the plot
plt.tight_layout()  # Ensure the layout fits
plt.show()
