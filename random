# Load the entire dataset into memory
df_salesforce = pd.read_excel('Data/LLM_Won_Analysis.xlsx')

# Manually split the DataFrame into chunks
chunk_size = 1000  # Adjust based on memory capacity
for i in range(0, len(df_salesforce), chunk_size):
    df_chunk = df_salesforce.iloc[i:i + chunk_size]
    
    # Process each chunk
    df_chunk.loc[:, 'combined_text'] = df_chunk['combined_text'].apply(truncate_to_4096_tokens)
    process_chunk(df_chunk)
