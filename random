# After all batches are processed and saved, we load the combined results:
df_final = pd.read_csv('new_Deals_Topic_Alignment_Output.csv')

# Apply category extraction to final_response_classify on the combined DataFrame 'df_final'
df_final[['category', 'explanation']] = df_final['final_response_classify'].apply(lambda x: pd.Series(extract_information_classify(x)))

# Apply topic alignment extraction to final_response_topic_alignment on the combined DataFrame 'df_final'
df_final[['topic_alignment', 'topic_explanation']] = df_final['final_response_topic_alignment'].apply(lambda x: pd.Series(extract_information_alignment(x)))

# Display results for verification
print(df_final[['category', 'explanation', 'topic_alignment', 'topic_explanation']].head())
