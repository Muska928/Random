# 8. Create a DataFrame with topic count and percentage
topic_counts_df = pd.DataFrame({
    'Topic': topic_counts.index,
    'Topic_Name': [top_words_per_topic[i] for i in topic_counts.index],
    'Count': topic_counts.values,
})

# Calculate the percentage of each topic
total_deals = len(non_rst_gt_3_tokens)
topic_counts_df['Percentage'] = (topic_counts_df['Count'] / total_deals) * 100

# Print the table
print(topic_counts_df)

# Save the table to a CSV file
topic_counts_df.to_csv('topic_wise_count_and_percentage.csv', index=False)
