# Assuming you want to preprocess the 'combined_text' column from df_salesforce
all_processed_texts = df_salesforce['combined_text'].apply(lambda x: full_preprocess(x))

# Now apply the normalization step properly within the preprocessing pipeline
# Step 5: Normalize multi-word phrases
all_processed_texts = all_processed_texts.apply(lambda text: normalize_phrases(text))

# Print counts of terms before and after preprocessing
print(f"Count of 'fund' before preprocessing: {df_salesforce['combined_text'].str.contains('fund').sum()}")
print(f"Count of 'fund' after preprocessing: {all_processed_texts.str.contains('fund').sum()}")
