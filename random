# ---- Exclude rows with empty text columns ----

# Identify and print the count of empty rows in each text column
empty_combined_text_count = non_rst_data['combined_text'].isna().sum() + (non_rst_data['combined_text'] == '').sum()
empty_record_comment_text_count = non_rst_data['record_comment_text'].isna().sum() + (non_rst_data['record_comment_text'] == '').sum()
empty_executive_summary_text_count = non_rst_data['executive_summary_text'].isna().sum() + (non_rst_data['executive_summary_text'] == '').sum()

print(f"\nTotal empty rows in 'combined_text': {empty_combined_text_count}")
print(f"Total empty rows in 'record_comment_text': {empty_record_comment_text_count}")
print(f"Total empty rows in 'executive_summary_text': {empty_executive_summary_text_count}")

# Filter out rows where 'combined_text' is empty
non_rst_data = non_rst_data[non_rst_data['combined_text'].notna() & (non_rst_data['combined_text'] != '')]

# Print the new number of rows after excluding empty rows
print(f"Total rows for analysis after excluding empty rows (if applicable): {len(non_rst_data)}")
